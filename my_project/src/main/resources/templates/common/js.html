<!doctype html>
<html lang="en">
<body>

</body>
<head>
    <meta charset="UTF-8">
    <title>js 집합</title>

    <!-- jQuery library -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- OpenLayers JS file -->
    <script src="https://cdn.jsdelivr.net/npm/ol@v7.4.0/dist/ol.js"></script>

    <!-- Bootstrap JS file -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>

    <script th:src="@{../static/js/ol/main.js}"></script>
    <script type="text/javascript" th:inline="javascript">
        $(function () {
        })
        let map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM({
                        url: 'https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png'
                    })
                })
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([126.985302, 37.566671]),
                zoom: 11
            })
        });
    </script>
    <!-- 장소 등록 폼에서 지도 띄우기 -->
    <script>
        var mapObj = null;

        function createMap() {
            var mapContainer = document.getElementById("map-container");
            // 동적으로 지도를 생성할 div 요소를 만듭니다.
            var mapElem = document.createElement("div");
            mapElem.style.width = "100%";
            mapElem.style.height = "400px";
            // 이전에 생성된 지도가 있다면 삭제합니다.
            if (mapObj) {
                mapObj.setTarget(null);
                mapObj = null;
                mapContainer.innerHTML = "";
            }
            mapContainer.append(mapElem);
            // 새로운 지도 객체를 생성합니다.
            mapObj = new ol.Map({
                target: mapElem,
                layers: [
                    new ol.layer.Tile({
                        source: new ol.source.OSM({
                            wrapX: false
                        })
                    })
                ],
                view: new ol.View({
                    center: ol.proj.fromLonLat([126.985302, 37.566671]),
                    zoom: 11
                })
            });
        }

        // 문서가 로드된 뒤 아래 코드가 실행됩니다.
        $(document).ready(function () {
            // 버튼에 클릭 이벤트 리스너를 등록합니다.
            $("#placeRegisterBtn").on("click", function () {
                createMap();
            });
        });

        <!-- 사이드바 안에서 검색을 했을 때 화면에 값 넘기기 -->
        var searchKeyword = "";

        $('[data-bs-target="#placeName"]').click(function () {
            searchKeyword = $("#searchInput").val();
            $("#searchResult").text("'" + searchKeyword + "' 검색 결과입니다.");
        });

        <!-- 사이드바 안에서 엔터 키로 검색을 했을 때 화면에 값 넘기기 -->
        $(document).keydown(function (e) {
            if (e.target.id === 'searchInput' && e.keyCode === 13) {
                e.preventDefault();
                $('[data-bs-target="#placeName"]').click();
            }
        });
        //클릭하기
        map.on('click', function (evt) {

            //var lonlat = ol.proj.transform(evt.coordinate, 'EPSG:3857', 'EPSG:4326');
            let coordinate = evt.coordinate;
            console.log(coordinate);
        })
    </script>
</head>
</html>